Purpose:
Adding security to AppRazor and AppMvc

Add Asp.Net.Core Identity Login capabilities

Steps:

AppRazor
----------
1. In Pages/Account/ add pages to login and logout
   Add a Login Razor page and model
   Add a Logout Razor page and model

2. In Program.cs after builder.Services.AddDefaultIdentity<User>(...) add configuration of own Login page
builder.Services.ConfigureApplicationCookie(options =>
{
    options.LoginPath = "/Account/Login";
    options.AccessDeniedPath = "/Account/Login";
    options.LogoutPath = "/Account/Logout";
    options.ExpireTimeSpan = TimeSpan.FromMinutes(60);
    options.SlidingExpiration = true;
    options.Cookie.HttpOnly = true;
    options.Cookie.SecurePolicy = CookieSecurePolicy.SameAsRequest; // Allow both HTTP and HTTPS in development
    options.Cookie.SameSite = SameSiteMode.Lax;
    options.Cookie.Name = "GoodMusicAuth";
});

3. In Pages/Shared add a Razor page partial, _LoginPartial  (it can be empty)

4. In _Layout.cshtml add Menu adaptions to show only logout if logged in, otherwise Login and Register
Add using statments
@using Microsoft.AspNetCore.Identity;
@using Models;
@inject UserManager<User> userManager;

5. In _Layout.cshtml add @if (!User.Identity.IsAuthenticated) to controll Login, Register, Logout meny items

6. Execute and login and logout users


AppMvc
--------
1. In AccountController add
   Actions LoginOk(...) and Logout (...)

   In Models add LoginViewModel

   In Views/Account add Login.cshtml

2. In Program.cs after builder.Services.AddDefaultIdentity<User>(...) add configuration of own Login page
builder.Services.ConfigureApplicationCookie(options =>
{
    options.LoginPath = "/Account/Login";
    options.AccessDeniedPath = "/Account/Login";
    options.LogoutPath = "/Account/Logout";
    options.ExpireTimeSpan = TimeSpan.FromMinutes(60);
    options.SlidingExpiration = true;
    options.Cookie.HttpOnly = true;
    options.Cookie.SecurePolicy = CookieSecurePolicy.SameAsRequest; // Allow both HTTP and HTTPS in development
    options.Cookie.SameSite = SameSiteMode.Lax;
    options.Cookie.Name = "GoodMusicAuth";
});

3. In Views/Shared/_Layout.cshtml add Menu adaptions to show only logout if logged in, otherwise Login and Register
Add using statments
@using Microsoft.AspNetCore.Identity;
@using Models;
@inject UserManager<User> userManager;

4. In _Layout.cshtml add @if (!User.Identity.IsAuthenticated) to controll Login, Register, Logout meny items
