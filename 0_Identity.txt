Purpose:
Adding security to AppRazor and AppMvc

Add Asp.Net.Core Identity
Add Asp.Net.Core Identity models to Application Database

Steps:

1. In Models User class should inherited from IdentityUser and map UserId to IdentityUser Id.
public class User : IdentityUser<Guid>, IUser
{}

2. In Db Context add name spaces
using Microsoft.AspNetCore.Identity;
using Microsoft.AspNetCore.Identity.EntityFrameworkCore;

3. In Db Context have csMainDbContext inherit from IdentityDbContext instead of DbContext
public class csMainDbContext : IdentityDbContext<User, IdentityRole<Guid>, Guid>

remove the line below as table Users is now created by Identity
    public DbSet<UserDbM> Users { get; set; }

AppRazor
-------
4. In Programs.cs make sure the app will use Authentication and Authorization
app.UseAuthentication();
app.UseAuthorization();

5. In AppRazor.csproj add references
    <PackageReference Include="Microsoft.AspNetCore.Identity.UI" Version="9.0.8" />

6. In Programs.cs add and configure IdentityServices to DbContext.csMainDbContext
//Add IdentityServices to DbContext.MainDbContext
builder.Services.AddDefaultIdentity<User>(options => {
    options.Password.RequireDigit = false;
    options.Password.RequireLowercase = false;
    options.Password.RequireNonAlphanumeric = false;
    options.Password.RequireUppercase = false;
    options.SignIn.RequireConfirmedAccount = false;
}).AddEntityFrameworkStores<DbContext.MainDbContext>();

7. Migrate and update the database. With Terminal in folder _scripts 

        ./database-rebuild-all.sh sql-music sqlserver docker dbo ../AppRazor
   or   
        ./database-rebuild-all.ps1 sql-music sqlserver docker dbo ../AppRazor

   Ensure no errors from build, migration or database update
   Execute the initDatabase.sql script in a database access tool


AppMvc
------
4. In Programs.cs make sure the app will use Authentication and Authorization
app.UseAuthentication();
app.UseAuthorization();

5. In AppMvc.csproj add references
    <PackageReference Include="Microsoft.AspNetCore.Identity.UI" Version="9.0.8" />

6. In AppMvc.Programs.cs add and configure IdentityServices to DbContext.csMainDbContext
//Add IdentityServices to DbContext.MainDbContext
builder.Services.AddDefaultIdentity<User>(options => {
    options.Password.RequireDigit = false;
    options.Password.RequireLowercase = false;
    options.Password.RequireNonAlphanumeric = false;
    options.Password.RequireUppercase = false;
    options.SignIn.RequireConfirmedAccount = false;
}).AddEntityFrameworkStores<DbContext.MainDbContext>();

7. Migrate and update the database. With Terminal in folder _scripts 

        ./database-rebuild-all.sh sql-music sqlserver docker dbo ../AppMvc
   or   
        ./database-rebuild-all.ps1 sql-music sqlserver docker dbo ../AppMvc

   Ensure no errors from build, migration or database update
   Execute the initDatabase.sql script in a database access tool